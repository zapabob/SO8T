# Safety-Aware SO8T å®Ÿè¡Œã‚¬ã‚¤ãƒ‰

CLIãªã—ã§å­¦ç¿’æ¨è«–å®Ÿè¨¼ã‚’å®Œå…¨å®Ÿè¡Œã™ã‚‹æ–¹æ³•

## ğŸš€ ç°¡å˜å®Ÿè¡Œ

### Windows (æ¨å¥¨)

```cmd
# ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œ
run_safety.bat

# ã¾ãŸã¯ç›´æ¥å®Ÿè¡Œ
python run_safety_complete.py
```

### PowerShell

```powershell
# PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
.\run_safety.ps1

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãå®Ÿè¡Œ
.\run_safety.ps1 -Config "configs/train_safety.yaml" -OutputDir "chk" -Seed 42
```

### Pythonç›´æ¥å®Ÿè¡Œ

```bash
# åŸºæœ¬å®Ÿè¡Œ
python run_safety_complete.py

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãå®Ÿè¡Œ
python run_safety_complete.py --config configs/train_safety.yaml --data_dir data --output_dir chk --seed 42
```

## ğŸ“‹ å®Ÿè¡Œã‚¹ãƒ†ãƒƒãƒ—

1. **èªå½™æ§‹ç¯‰** - è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰èªå½™ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
2. **å­¦ç¿’** - å®‰å…¨é‡è¦–SO8Tãƒ¢ãƒ‡ãƒ«ã®è¨“ç·´
3. **å¯è¦–åŒ–** - è¨“ç·´çµæœã®å¯è¦–åŒ–
4. **ãƒ†ã‚¹ãƒˆ** - å®‰å…¨æ¨è«–ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
5. **å®Ÿè¨¼** - åŒ…æ‹¬çš„ãªå®Ÿè¨¼ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
6. **ãƒ­ã‚°ç”Ÿæˆ** - å®Ÿè£…ãƒ­ã‚°ã®è‡ªå‹•ç”Ÿæˆ

## âš™ï¸ ã‚ªãƒ—ã‚·ãƒ§ãƒ³

### åŸºæœ¬ã‚ªãƒ—ã‚·ãƒ§ãƒ³

- `--config`: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `configs/train_safety.yaml`)
- `--data_dir`: ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `data`)
- `--output_dir`: å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `chk`)
- `--seed`: ä¹±æ•°ã‚·ãƒ¼ãƒ‰ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 42)
- `--no_resume`: è‡ªå‹•å¾©æ—§ã‚’ç„¡åŠ¹åŒ–

### ã‚¹ã‚­ãƒƒãƒ—ã‚ªãƒ—ã‚·ãƒ§ãƒ³

- `--skip_training`: å­¦ç¿’ã‚¹ãƒ†ãƒƒãƒ—ã‚’ã‚¹ã‚­ãƒƒãƒ—
- `--skip_visualization`: å¯è¦–åŒ–ã‚¹ãƒ†ãƒƒãƒ—ã‚’ã‚¹ã‚­ãƒƒãƒ—
- `--skip_testing`: ãƒ†ã‚¹ãƒˆã‚¹ãƒ†ãƒƒãƒ—ã‚’ã‚¹ã‚­ãƒƒãƒ—
- `--skip_demonstration`: å®Ÿè¨¼ã‚¹ãƒ†ãƒƒãƒ—ã‚’ã‚¹ã‚­ãƒƒãƒ—

## ğŸ“Š ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«

### å­¦ç¿’é–¢é€£
- `chk/safety_model_best.pt` - å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«
- `chk/safety_training_log.jsonl` - è¨“ç·´ãƒ­ã‚°
- `chk/autosave/` - ã‚ªãƒ¼ãƒˆã‚»ãƒ¼ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«

### å¯è¦–åŒ–
- `chk/safety_visualizations/safety_training_curves.png` - è¨“ç·´æ›²ç·š
- `chk/safety_visualizations/safety_metrics_heatmap.png` - ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
- `chk/safety_visualizations/safety_improvement.png` - å®‰å…¨æ”¹å–„æ¨ç§»

### ãƒ†ã‚¹ãƒˆãƒ»å®Ÿè¨¼
- `chk/safety_test_results/safety_test_results.png` - ãƒ†ã‚¹ãƒˆçµæœ
- `chk/safety_demonstration_results/safety_demonstration_results.png` - å®Ÿè¨¼çµæœ
- `chk/safety_demonstration_results/safety_demonstration_report.txt` - å®Ÿè¨¼ãƒ¬ãƒãƒ¼ãƒˆ

### ãƒ­ã‚°
- `_docs/yyyy-mm-dd_å®‰å…¨é‡è¦–SO8Tå®Ÿè£….md` - å®Ÿè£…ãƒ­ã‚°

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

1. **Python not found**
   - Python 3.8+ ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„
   - PATHã«Pythonã‚’è¿½åŠ ã—ã¦ãã ã•ã„

2. **Missing required files**
   - å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œã—ã¦ãã ã•ã„

3. **Vocabulary not found**
   - èªå½™ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•æ§‹ç¯‰ã•ã‚Œã¾ã™
   - ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆtrain.jsonl, val.jsonl, test.jsonlï¼‰ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„

4. **CUDA not available**
   - CPUã§ã‚‚å®Ÿè¡Œå¯èƒ½ã§ã™
   - GPUã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯CUDAã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„

### ãƒ­ã‚°ç¢ºèª

å®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ä»¥ä¸‹ã®ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

- ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰
- `chk/safety_training_log.jsonl`ï¼ˆè¨“ç·´ãƒ­ã‚°ï¼‰
- `_docs/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆå®Ÿè£…ãƒ­ã‚°ï¼‰

## ğŸ“ˆ å®Ÿè¡Œä¾‹

### å®Œå…¨å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰

```bash
python run_safety_complete.py
```

### å­¦ç¿’ã®ã¿ã‚¹ã‚­ãƒƒãƒ—ï¼ˆæ—¢å­˜ãƒ¢ãƒ‡ãƒ«ä½¿ç”¨ï¼‰

```bash
python run_safety_complete.py --skip_training
```

### ã‚«ã‚¹ã‚¿ãƒ è¨­å®š

```bash
python run_safety_complete.py --config my_config.yaml --output_dir my_results --seed 123
```

## ğŸ¯ æœŸå¾…ã•ã‚Œã‚‹çµæœ

å®Ÿè¡Œå®Œäº†å¾Œã€ä»¥ä¸‹ã®çµæœãŒå¾—ã‚‰ã‚Œã¾ã™ï¼š

- **REFUSEå†ç¾ç‡**: â‰¥70% (å±é™ºæŒ‡ç¤ºã®é©åˆ‡ãªæ‹’å¦)
- **ESCALATEå†ç¾ç‡**: â‰¥50% (è¤‡é›‘ãªåˆ¤æ–­ã®äººé–“å§”è­²)
- **éåº¦ãªå¾“é †ç‡**: â‰¤30% (å±é™ºãªçŠ¶æ³ã§ã®ç›²ç›®çš„å¾“é †é˜²æ­¢)
- **ç·åˆå®‰å…¨ã‚¹ã‚³ã‚¢**: â‰¥60% (å…¨ä½“çš„ãªå®‰å…¨æ€§)

## ğŸ å®Œäº†ç¢ºèª

å®Ÿè¡ŒãŒæˆåŠŸã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

```
ğŸ‰ Pipeline completed successfully!
â±ï¸  Total execution time: XXX.X seconds
ğŸ“ Output directory: chk
```

ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã¦ã€æœŸå¾…ã•ã‚Œã‚‹çµæœãŒå¾—ã‚‰ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
